import{p as e,a as s,u as t,o,c as i,b as n,n as a,d as l,e as r,t as c,f as u,w as d,v as p,g as m,I as g,F as v,r as y,h as f,i as x,j as _,k as h,l as b,m as I,q as C,s as L,x as P}from"./vendor.8656136d.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)})).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?s.credentials="include":"anonymous"===e.crossorigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();const M=e=>{let s=new Date(1e3*e).toISOString().substr(11,8);return 0===s.indexOf("00:")?s.substr(3):s},k=(e,s)=>0===e?s:s===e-1?0:s+1,w={once:!0};e("data-v-2532c2df");const N=["src"],T=n("div",{class:"circle"},null,-1);s();const q={props:{isPlay:{type:Boolean,require:!0},src:{type:String,require:!0},m:{type:String,default:"0"},imgP:{type:String,default:"6px"},style:{type:Object,default:()=>({})}},setup(e){const s=e;return t((t=>({"417df795":`url(${s.src})`,"0c601878":e.m}))),(t,r)=>(o(),i("div",{class:"music-avatar",style:l(s.style)},[n("img",{src:e.src,alt:"",class:a({play:e.isPlay,paused:!e.isPlay})},null,10,N),T],4))},__scopeId:"data-v-2532c2df"};e("data-v-20a3bb18");const S={class:"container"},B={class:"cur-time"},E={class:"duration"};s();const A={props:{curTime:{type:Number,require:!0},duration:{type:Number,require:!0}},emits:["change_progress"],setup(e,{emit:s}){const a=e;t((e=>({c37570fe:`${u(d)}%`})));const l=e=>{const t=e.target,o=e.clientX,{width:i,left:n}=t.getBoundingClientRect();s("change_progress",Number(((o-n)/i).toFixed(2)))},d=r((()=>0===a.duration||0===a.curTime?0:a.curTime/a.duration*100));return(s,t)=>(o(),i("div",S,[n("div",B,c(u(M)(e.curTime)),1),n("div",{id:"progress-bar",onClick:l}),n("div",E,c(u(M)(e.duration)),1)]))},__scopeId:"data-v-20a3bb18"};e("data-v-4b667f50");const D={class:"container"},F={class:"icons"};s();const O={props:{isMuted:{type:Boolean,require:!0},volume:{type:Number,default:.5},test:{type:Number,default:.5}},emits:["change_volume","change_mute"],setup(e,{emit:s}){t((s=>({"641e9aba":100*e.volume+"%"})));const a=e=>{const t=e.target,o=e.clientX,{width:i,left:n}=t.getBoundingClientRect();s("change_volume",Number(((o-n)/i).toFixed(2)))};return(t,l)=>(o(),i("div",D,[n("div",F,[d(m(u(g),{icon:e.isMuted?"bx:bx-volume-mute":"bx:bx-volume-low",width:"1.2rem",color:"#fff",class:"icon",onClick:l[0]||(l[0]=e=>s("change_mute"))},null,8,["icon"]),[[p,e.volume<.5]]),d(m(u(g),{icon:e.isMuted?"bx:bx-volume-mute":"bx:bx-volume-full",width:"1.2rem",color:"#fff",class:"icon",onClick:l[1]||(l[1]=e=>s("change_mute"))},null,8,["icon"]),[[p,e.volume>=.5]])]),n("div",{class:"progress",onClick:a})]))},__scopeId:"data-v-4b667f50"};e("data-v-0858f8b0");const j={class:"container"};s();const R={props:{mode:{type:String,default:"single_loop"}},emits:["change_mode"],setup:(e,{emit:s})=>(t,n)=>(o(),i("div",j,[m(u(g),{icon:""+(e.mode===u("single_loop")?"carbon:repeat-one":e.mode===u("all_loop")?"carbon:repeat":"bi:music-note-list"),color:"white",width:"1.2rem",class:"icon",onClick:n[0]||(n[0]=t=>s("change_mode",e.mode===u("single_loop")?u("all_loop"):e.mode===u("all_loop")?u("list_loop"):u("single_loop")))},null,8,["icon"])])),__scopeId:"data-v-0858f8b0"};e("data-v-3962c632");const J={class:"container"},X=["onClick"],$={class:"item"},K={key:1};s();const U={props:{songList:{type:Array,require:!0},setCurIdx:{type:Function,require:!0},curIdx:{type:Number,require:!0},isPlay:{type:Boolean,require:!0}},emits:["play"],setup(e,{emit:s}){const t=e;return(l,r)=>(o(),i("div",J,[n("ul",null,[(o(!0),i(v,null,y(e.songList,((l,r)=>(o(),i("li",{key:l.id,onClick:()=>(e=>{s("play"),t.setCurIdx(e)})(r),class:a({current:r===e.curIdx})},[n("div",$,[r===e.curIdx?(o(),f(u(g),{key:0,icon:"fluent:music-note-2-play-20-filled",width:"20",height:"20",class:a({play:e.isPlay,pause:e.isPlay,icon:e.isPlay})},null,8,["class"])):(o(),i("span",K,c(r+1),1)),n("span",null,c(l.artist.length>0?l.artist:"未知来源"),1),n("span",null,c(l.songName),1)])],10,X)))),128))])]))},__scopeId:"data-v-3962c632"},z={class:"music-player-wrapper"},G=["src"],H={class:"content"},Q={class:"info"},V={class:"name"},W={class:"artist"},Y={class:"control"},Z={class:"action"},ee={props:{songList:{type:Array,default:[{src:"1.mp3",pic:"1.png",artist:"JJ Lin",songName:"Allways online",id:"xxxxxxxxx-xxxx-4xxx".replace(/[xy]/g,(e=>{let s,t;return t=16*Math.random()|0,s="x"===e?t:3&t|8,s.toString(16)}))}]},loopMode:{type:String,default:"single_loop"},volume:{type:Number,default:.3},isMuted:{type:Boolean,default:!1}},setup(e){const s=e,{isMuted:t,volume:a,loopMode:l}=s,d=x({v_isMuted:t,v_loopMode:l,v_volume:a,isPlay:!1,curTime:0,curIdx:0,curDuration:0,isCanplay:!1}),p=_(null),v=r((()=>{const{src:e="1.mp3",pic:t="1.png",artist:o="未知",songName:i="未知"}=s.songList[d.curIdx]||{};return{src:e,pic:t,songName:i,artist:o}})),y=(e="turn")=>{var t,o;if(0!==s.songList.length)if("turn"===e)d.isPlay=!d.isPlay;else{const i=d.curIdx;"next"===e?d.curIdx=k(s.songList.length,i):"prev"===e&&(d.curIdx=(t=s.songList.length,o=i,0===t?o:0===o?t-1:o-1))}};h(d,(()=>{const e=p.value;e&&(d.curDuration=e.duration,e.volume=d.v_volume,e.muted=d.v_isMuted,e.paused&&d.isPlay?d.isCanplay&&setTimeout((()=>{e.play()}),30):e.paused||d.isPlay||e.pause())}));const C=e=>d.v_loopMode=e,L=()=>d.v_isMuted=!d.v_isMuted,P=e=>d.v_volume=e,M=e=>{const s=p.value;s&&(s.currentTime=d.duration*e)};return b((()=>{const e=p.value,t=()=>{0!==e.currentTime&&d.curTime<d.duration&&(d.curTime=e.currentTime)},o=()=>{d.curTime=0,"all_loop"===d.v_loopMode?(d.isCanplay=!1,d.curIdx=k(s.songList.length,d.curIdx)):"list_loop"===d.v_loopMode?d.curIdx!==s.songList.length-1?(d.isCanplay=!1,d.curIdx=k(s.songList.length,d.curIdx)):(d.isCanplay=!0,d.isPlay=!1):d.isPlay=!0};e.addEventListener("durationchange",(()=>{d.duration=e.duration,e.addEventListener("timeupdate",t),e.addEventListener("ended",o,w),e.addEventListener("canplay",(()=>d.isCanplay=!0),w)}))})),(e,t)=>(o(),i("div",z,[n("audio",{ref:(e,s)=>{s.audioRef=e,p.value=e},src:u(v).src,preload:"auto"},null,8,G),n("div",H,[m(q,{src:u(v).pic,isPlay:u(d).isPlay},null,8,["src","isPlay"]),n("div",Q,[n("div",V,c(u(v).songName),1),n("div",W,c(u(v).artist),1)]),n("div",Y,[n("div",Z,[m(u(g),{onClick:t[0]||(t[0]=()=>y("prev")),class:"icon",icon:"bx:bxs-skip-previous-circle",color:"#fff",width:"1.6rem"}),m(u(g),{onClick:t[1]||(t[1]=()=>y()),class:"icon",icon:u(d).isPlay?"mdi:motion-pause-outline":"mdi:motion-play-outline",color:"#fff",width:"2rem"},null,8,["icon"]),m(u(g),{onClick:t[2]||(t[2]=()=>y("next")),class:"icon",icon:"bx:bxs-skip-next-circle",color:"#fff",width:"1.6rem"})]),m(O,{volume:u(d).v_volume,isMuted:u(d).v_isMuted,onChange_mute:L,onChange_volume:P},null,8,["volume","isMuted"])]),m(A,{curTime:u(d).curTime,duration:u(d).curDuration,onChange_progress:M},null,8,["curTime","duration"]),m(R,{onChange_mode:C,mode:u(d).v_loopMode},null,8,["mode"])]),s.songList.length>0?(o(),f(U,{key:0,songList:s.songList,setCurIdx:e=>u(d).curIdx=e,curIdx:u(d).curIdx,isPlay:u(d).isPlay,onPlay:t[3]||(t[3]=()=>u(d).isPlay=!0)},null,8,["songList","setCurIdx","curIdx","isPlay"])):I("",!0)]))}};P({setup(e){const s=_([]);return L((async()=>{const e=await async function(){const{data:e}=await C.get("http://110.42.133.25:3333/api/songs");return e.data}();s.value=e.map((e=>{const{url:s,songId:t,artist:o,picUrl:i,songName:n}=e;return{src:s,pic:i,id:t.toString(),artist:o,songName:n}}))})),(e,t)=>(o(),f(ee,{songList:s.value},null,8,["songList"]))}}).mount("#app");
