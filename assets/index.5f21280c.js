import{p as e,a as t,u as s,o,c as i,n,b as a,d as r,e as l,t as c,f as u,g as d,I as p,h as m,F as g,r as y,i as v,j as f,w as x,k as _,l as h,m as b,q as I,s as C}from"./vendor.af4247ab.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const L=()=>"xxxxxxxxx-xxxx-4xxx".replace(/[xy]/g,(e=>{let t,s;return s=16*Math.random()|0,t="x"===e?s:3&s|8,t.toString(16)})),P=e=>{let t=new Date(1e3*e).toISOString().substr(11,8);return 0===t.indexOf("00:")?t.substr(3):t},M=(e,t)=>0===e?t:t===e-1?0:t+1,N={once:!0};e("data-v-01af3e97");const k=[r("div",{class:"circle"},null,-1)];t();const w={props:{isPlay:{type:Boolean,require:!0},src:{type:String,require:!0},m:{type:String,default:"0"},imgP:{type:String,default:"6px"},style:{type:Object,default:()=>({})}},setup(e){const t=e;return s((s=>({"1135831c":`url(${t.src})`,"094f27e1":e.m}))),(s,r)=>(o(),i("div",{class:n({play:e.isPlay,paused:!e.isPlay,"music-avatar":!0}),style:a(t.style)},k,6))},__scopeId:"data-v-01af3e97"};e("data-v-20a3bb18");const T={class:"container"},q={class:"cur-time"},S={class:"duration"};t();const B={props:{curTime:{type:Number,require:!0},duration:{type:Number,require:!0}},emits:["change_progress"],setup(e,{emit:t}){const n=e;s((e=>({c37570fe:`${u(d)}%`})));const a=e=>{const s=e.target,o=e.clientX,{width:i,left:n}=s.getBoundingClientRect();t("change_progress",Number(((o-n)/i).toFixed(2)))},d=l((()=>0===n.duration||0===n.curTime?0:n.curTime/n.duration*100));return(t,s)=>(o(),i("div",T,[r("div",q,c(u(P)(e.curTime)),1),r("div",{id:"progress-bar",onClick:a}),r("div",S,c(u(P)(e.duration)),1)]))},__scopeId:"data-v-20a3bb18"};e("data-v-09a977cc");const E={class:"container"};t();const A={props:{isMuted:{type:Boolean,require:!0},volume:{type:Number,default:.5},test:{type:Number,default:.5}},emits:["change_volume","change_mute"],setup(e,{emit:t}){s((t=>({a8749fba:100*e.volume+"%"})));const n=e=>{const s=e.target,o=e.clientX,{width:i,left:n}=s.getBoundingClientRect();t("change_volume",Number(((o-n)/i).toFixed(2)))};return(s,a)=>(o(),i("div",E,[d(u(p),{icon:e.isMuted?"bx:bx-volume-mute":e.volume>=.5?"bx:bx-volume-full":"bx:bx-volume-low",width:"1.2rem",color:"#fff",class:"icon",onClick:a[0]||(a[0]=e=>t("change_mute"))},null,8,["icon"]),r("div",{class:"progress",onClick:n})]))},__scopeId:"data-v-09a977cc"};const D={props:{mode:{type:String,default:"single_loop"}},emits:["change_mode"],setup:(e,{emit:t})=>(s,i)=>(o(),m(u(p),{icon:""+(e.mode===u("single_loop")?"carbon:repeat-one":e.mode===u("all_loop")?"carbon:repeat":"bi:music-note-list"),color:"white",width:"1.2rem",class:"icon",onClick:i[0]||(i[0]=s=>t("change_mode",e.mode===u("single_loop")?u("all_loop"):e.mode===u("all_loop")?u("list_loop"):u("single_loop")))},null,8,["icon"])),__scopeId:"data-v-00af7447"};e("data-v-3962c632");const F={class:"container"},O=["onClick"],j={class:"item"},R={key:1};t();const J={props:{songList:{type:Array,require:!0},setCurIdx:{type:Function,require:!0},curIdx:{type:Number,require:!0},isPlay:{type:Boolean,require:!0}},emits:["play"],setup(e,{emit:t}){const s=e;return(a,l)=>(o(),i("div",F,[r("ul",null,[(o(!0),i(g,null,y(e.songList,((a,l)=>(o(),i("li",{key:a.id,onClick:()=>(e=>{t("play"),s.setCurIdx(e)})(l),class:n({current:l===e.curIdx})},[r("div",j,[l===e.curIdx?(o(),m(u(p),{key:0,icon:"fluent:music-note-2-play-20-filled",width:"20",height:"20",class:n({play:e.isPlay,pause:e.isPlay,icon:e.isPlay})},null,8,["class"])):(o(),i("span",R,c(l+1),1)),r("span",null,c(a.artist.length>0?a.artist:"未知来源"),1),r("span",null,c(a.songName),1)])],10,O)))),128))])]))},__scopeId:"data-v-3962c632"},X={class:"music-player-wrapper"},$=["src"],K={class:"content"},U={class:"info"},z={class:"name"},G={class:"artist"},H={class:"control"},Q={class:"action"},V={props:{songList:{type:Array,default:[{src:"/1.mp3",pic:"/1.png",artist:"JJ Lin",songName:"Allways online",id:L()},{src:"/2.mp3",pic:"/2.png",songName:"山川",artist:"李荣浩",id:L()}]},loopMode:{type:String,default:"single_loop"},volume:{type:Number,default:.3},isMuted:{type:Boolean,default:!1}},setup(e){const t=e,{isMuted:s,volume:n,loopMode:a}=t,g=v({v_isMuted:s,v_loopMode:a,v_volume:n,isPlay:!1,curTime:0,curIdx:0,curDuration:0,isCanplay:!1}),y=f(null),b=l((()=>{const{src:e="/1.mp3",pic:s="/1.png",artist:o="林俊杰",songName:i="allways online"}=t.songList[g.curIdx]||{};return{src:e,pic:s,songName:i,artist:o}})),I=(e="turn")=>{var s,o;if(0!==t.songList.length)if("turn"===e)g.isPlay=!g.isPlay;else{const i=g.curIdx;"next"===e?g.curIdx=M(t.songList.length,i):"prev"===e&&(g.curIdx=(s=t.songList.length,o=i,0===s?o:0===o?s-1:o-1))}};x(g,(()=>{const e=y.value;e&&(g.curDuration=e.duration,e.volume=g.v_volume,e.muted=g.v_isMuted,e.paused&&g.isPlay?g.isCanplay&&setTimeout((()=>{e.play()}),30):e.paused||g.isPlay||e.pause())}));const C=e=>g.v_loopMode=e,L=()=>g.v_isMuted=!g.v_isMuted,P=e=>g.v_volume=e,k=e=>{const t=y.value;t&&(t.currentTime=g.duration*e)};return _((()=>{const e=y.value,s=()=>{0!==e.currentTime&&g.curTime<g.duration&&(g.curTime=e.currentTime)},o=()=>{g.curTime=0,"all_loop"===g.v_loopMode?(g.isCanplay=!1,g.curIdx=M(t.songList.length,g.curIdx)):"list_loop"===g.v_loopMode?g.curIdx!==t.songList.length-1?(g.isCanplay=!1,g.curIdx=M(t.songList.length,g.curIdx)):(g.isCanplay=!0,g.isPlay=!1):g.isPlay=!0};e.addEventListener("durationchange",(()=>{g.duration=e.duration,e.addEventListener("timeupdate",s),e.addEventListener("ended",o,N),e.addEventListener("canplay",(()=>g.isCanplay=!0),N)}))})),(e,s)=>(o(),i("div",X,[r("audio",{ref:(e,t)=>{t.audioRef=e,y.value=e},src:u(b).src,preload:"auto"},null,8,$),r("div",K,[d(w,{src:u(b).pic,isPlay:u(g).isPlay},null,8,["src","isPlay"]),r("div",U,[r("div",z,c(u(b).songName),1),r("div",G,c(u(b).artist),1)]),r("div",H,[r("div",Q,[d(u(p),{onClick:s[0]||(s[0]=()=>I("prev")),class:"icon",icon:"bx:bxs-skip-previous-circle",color:"#fff",width:"1.6rem"}),d(u(p),{onClick:s[1]||(s[1]=()=>I()),class:"icon",icon:u(g).isPlay?"mdi:motion-pause-outline":"mdi:motion-play-outline",color:"#fff",width:"2rem"},null,8,["icon"]),d(u(p),{onClick:s[2]||(s[2]=()=>I("next")),class:"icon",icon:"bx:bxs-skip-next-circle",color:"#fff",width:"1.6rem"})]),d(A,{volume:u(g).v_volume,isMuted:u(g).v_isMuted,onChange_mute:L,onChange_volume:P},null,8,["volume","isMuted"])]),d(B,{curTime:u(g).curTime,duration:u(g).curDuration,onChange_progress:k},null,8,["curTime","duration"]),d(D,{onChange_mode:C,mode:u(g).v_loopMode},null,8,["mode"])]),t.songList.length>0?(o(),m(J,{key:0,songList:t.songList,setCurIdx:e=>u(g).curIdx=e,curIdx:u(g).curIdx,isPlay:u(g).isPlay,onPlay:s[3]||(s[3]=()=>u(g).isPlay=!0)},null,8,["songList","setCurIdx","curIdx","isPlay"])):h("",!0)]))}};C({setup(e){const t=f([]);return I((async()=>{const e=await async function(){const{data:e}=await b.get("http://110.42.133.25:3333/api/songs");return e.data}();t.value=e.map((e=>{const{url:t,songId:s,artist:o,picUrl:i,songName:n}=e;return{src:t,pic:i,id:s.toString(),artist:o,songName:n}}))})),(e,s)=>(o(),m(V,{songList:t.value},null,8,["songList"]))}}).mount("#app");
