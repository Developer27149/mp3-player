import{p as e,a as s,u as t,o,c as i,n,b as a,d as r,e as l,t as c,f as u,g as d,I as p,h as m,F as g,r as y,i as v,j as f,w as x,k as _,l as h,m as b,q as I,s as C}from"./vendor.af4247ab.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)})).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?s.credentials="include":"anonymous"===e.crossorigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();const L=()=>"xxxxxxxxx-xxxx-4xxx".replace(/[xy]/g,(e=>{let s,t;return t=16*Math.random()|0,s="x"===e?t:3&t|8,s.toString(16)})),P=e=>{let s=new Date(1e3*e).toISOString().substr(11,8);return 0===s.indexOf("00:")?s.substr(3):s},N=(e,s)=>0===e?s:s===e-1?0:s+1,M={once:!0};e("data-v-01af3e97");const k=[r("div",{class:"circle"},null,-1)];s();const w={props:{isPlay:{type:Boolean,require:!0},src:{type:String,require:!0},m:{type:String,default:"0"},imgP:{type:String,default:"6px"},style:{type:Object,default:()=>({})}},setup(e){const s=e;return t((t=>({"1135831c":`url(${s.src})`,"094f27e1":e.m}))),(t,r)=>(o(),i("div",{class:n({play:e.isPlay,paused:!e.isPlay,"music-avatar":!0}),style:a(s.style)},k,6))},__scopeId:"data-v-01af3e97"};e("data-v-20a3bb18");const T={class:"container"},q={class:"cur-time"},S={class:"duration"};s();const B={props:{curTime:{type:Number,require:!0},duration:{type:Number,require:!0}},emits:["change_progress"],setup(e,{emit:s}){const n=e;t((e=>({c37570fe:`${u(d)}%`})));const a=e=>{const t=e.target,o=e.clientX,{width:i,left:n}=t.getBoundingClientRect();s("change_progress",Number(((o-n)/i).toFixed(2)))},d=l((()=>0===n.duration||0===n.curTime?0:n.curTime/n.duration*100));return(s,t)=>(o(),i("div",T,[r("div",q,c(u(P)(e.curTime)),1),r("div",{id:"progress-bar",onClick:a}),r("div",S,c(u(P)(e.duration)),1)]))},__scopeId:"data-v-20a3bb18"};e("data-v-09a977cc");const E={class:"container"};s();const A={props:{isMuted:{type:Boolean,require:!0},volume:{type:Number,default:.5},test:{type:Number,default:.5}},emits:["change_volume","change_mute"],setup(e,{emit:s}){t((s=>({a8749fba:100*e.volume+"%"})));const n=e=>{const t=e.target,o=e.clientX,{width:i,left:n}=t.getBoundingClientRect();s("change_volume",Number(((o-n)/i).toFixed(2)))};return(t,a)=>(o(),i("div",E,[d(u(p),{icon:e.isMuted?"bx:bx-volume-mute":e.volume>=.5?"bx:bx-volume-full":"bx:bx-volume-low",width:"1.2rem",color:"#fff",class:"icon",onClick:a[0]||(a[0]=e=>s("change_mute"))},null,8,["icon"]),r("div",{class:"progress",onClick:n})]))},__scopeId:"data-v-09a977cc"};const D={props:{mode:{type:String,default:"single_loop"}},emits:["change_mode"],setup:(e,{emit:s})=>(t,i)=>(o(),m(u(p),{icon:""+(e.mode===u("single_loop")?"carbon:repeat-one":e.mode===u("all_loop")?"carbon:repeat":"bi:music-note-list"),color:"white",width:"1.2rem",class:"icon",onClick:i[0]||(i[0]=t=>s("change_mode",e.mode===u("single_loop")?u("all_loop"):e.mode===u("all_loop")?u("list_loop"):u("single_loop")))},null,8,["icon"])),__scopeId:"data-v-00af7447"};e("data-v-3962c632");const F={class:"container"},O=["onClick"],j={class:"item"},J={key:1};s();const R={props:{songList:{type:Array,require:!0},setCurIdx:{type:Function,require:!0},curIdx:{type:Number,require:!0},isPlay:{type:Boolean,require:!0}},emits:["play"],setup(e,{emit:s}){const t=e;return(a,l)=>(o(),i("div",F,[r("ul",null,[(o(!0),i(g,null,y(e.songList,((a,l)=>(o(),i("li",{key:a.id,onClick:()=>(e=>{s("play"),t.setCurIdx(e)})(l),class:n({current:l===e.curIdx})},[r("div",j,[l===e.curIdx?(o(),m(u(p),{key:0,icon:"fluent:music-note-2-play-20-filled",width:"20",height:"20",class:n({play:e.isPlay,pause:e.isPlay,icon:e.isPlay})},null,8,["class"])):(o(),i("span",J,c(l+1),1)),r("span",null,c(a.artist.length>0?a.artist:"未知来源"),1),r("span",null,c(a.songName),1)])],10,O)))),128))])]))},__scopeId:"data-v-3962c632"},X={class:"music-player-wrapper"},$=["src"],K={class:"content"},U={class:"info"},z={class:"name"},G={class:"artist"},H={class:"control"},Q={class:"action"},V={props:{songList:{type:Array,default:[{src:"1.mp3",pic:"1.png",artist:"JJ Lin",songName:"Allways online",id:L()},{src:"2.mp3",pic:"2.png",songName:"山川",artist:"李荣浩",id:L()},{src:"3.mp3",pic:"1.png",artist:"Jay",songName:"一路向北",id:L()},{src:"4.mp3",pic:"2.png",songName:"触不可及",artist:"佚名",id:L()}]},loopMode:{type:String,default:"single_loop"},volume:{type:Number,default:.3},isMuted:{type:Boolean,default:!1}},setup(e){const s=e,{isMuted:t,volume:n,loopMode:a}=s,g=v({v_isMuted:t,v_loopMode:a,v_volume:n,isPlay:!1,curTime:0,curIdx:0,curDuration:0,isCanplay:!1}),y=f(null),b=l((()=>{const{src:e="1.mp3",pic:t="1.png",artist:o="林俊杰",songName:i="allways online"}=s.songList[g.curIdx]||{};return{src:e,pic:t,songName:i,artist:o}})),I=(e="turn")=>{var t,o;if(0!==s.songList.length)if("turn"===e)g.isPlay=!g.isPlay;else{const i=g.curIdx;"next"===e?g.curIdx=N(s.songList.length,i):"prev"===e&&(g.curIdx=(t=s.songList.length,o=i,0===t?o:0===o?t-1:o-1))}};x(g,(()=>{const e=y.value;e&&(g.curDuration=e.duration,e.volume=g.v_volume,e.muted=g.v_isMuted,e.paused&&g.isPlay?g.isCanplay&&setTimeout((()=>{e.play()}),30):e.paused||g.isPlay||e.pause())}));const C=e=>g.v_loopMode=e,L=()=>g.v_isMuted=!g.v_isMuted,P=e=>g.v_volume=e,k=e=>{const s=y.value;s&&(s.currentTime=g.duration*e)};return _((()=>{const e=y.value,t=()=>{0!==e.currentTime&&g.curTime<g.duration&&(g.curTime=e.currentTime)},o=()=>{g.curTime=0,"all_loop"===g.v_loopMode?(g.isCanplay=!1,g.curIdx=N(s.songList.length,g.curIdx)):"list_loop"===g.v_loopMode?g.curIdx!==s.songList.length-1?(g.isCanplay=!1,g.curIdx=N(s.songList.length,g.curIdx)):(g.isCanplay=!0,g.isPlay=!1):g.isPlay=!0};e.addEventListener("durationchange",(()=>{g.duration=e.duration,e.addEventListener("timeupdate",t),e.addEventListener("ended",o,M),e.addEventListener("canplay",(()=>g.isCanplay=!0),M)}))})),(e,t)=>(o(),i("div",X,[r("audio",{ref:(e,s)=>{s.audioRef=e,y.value=e},src:u(b).src,preload:"auto"},null,8,$),r("div",K,[d(w,{src:u(b).pic,isPlay:u(g).isPlay},null,8,["src","isPlay"]),r("div",U,[r("div",z,c(u(b).songName),1),r("div",G,c(u(b).artist),1)]),r("div",H,[r("div",Q,[d(u(p),{onClick:t[0]||(t[0]=()=>I("prev")),class:"icon",icon:"bx:bxs-skip-previous-circle",color:"#fff",width:"1.6rem"}),d(u(p),{onClick:t[1]||(t[1]=()=>I()),class:"icon",icon:u(g).isPlay?"mdi:motion-pause-outline":"mdi:motion-play-outline",color:"#fff",width:"2rem"},null,8,["icon"]),d(u(p),{onClick:t[2]||(t[2]=()=>I("next")),class:"icon",icon:"bx:bxs-skip-next-circle",color:"#fff",width:"1.6rem"})]),d(A,{volume:u(g).v_volume,isMuted:u(g).v_isMuted,onChange_mute:L,onChange_volume:P},null,8,["volume","isMuted"])]),d(B,{curTime:u(g).curTime,duration:u(g).curDuration,onChange_progress:k},null,8,["curTime","duration"]),d(D,{onChange_mode:C,mode:u(g).v_loopMode},null,8,["mode"])]),s.songList.length>0?(o(),m(R,{key:0,songList:s.songList,setCurIdx:e=>u(g).curIdx=e,curIdx:u(g).curIdx,isPlay:u(g).isPlay,onPlay:t[3]||(t[3]=()=>u(g).isPlay=!0)},null,8,["songList","setCurIdx","curIdx","isPlay"])):h("",!0)]))}};C({setup(e){const s=f([]);return I((async()=>{const e=await async function(){const{data:e}=await b.get("http://110.42.133.25:3333/api/songs");return e.data}();s.value=e.map((e=>{const{url:s,songId:t,artist:o,picUrl:i,songName:n}=e;return{src:s,pic:i,id:t.toString(),artist:o,songName:n}}))})),(e,t)=>(o(),m(V,{songList:s.value},null,8,["songList"]))}}).mount("#app");
