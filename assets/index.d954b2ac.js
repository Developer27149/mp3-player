import{u as e,o as s,c as t,n as o,a as i,p as n,b as r,d as a,e as l,t as c,f as u,g as d,I as p,h as m,F as g,r as y,i as v,j as f,w as x,k as _,l as h,m as b,q as I,s as C}from"./vendor.9cababe6.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)})).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?s.credentials="include":"anonymous"===e.crossorigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();const L=()=>"xxxxxxxxx-xxxx-4xxx".replace(/[xy]/g,(e=>{let s,t;return t=16*Math.random()|0,s="x"===e?t:3&t|8,s.toString(16)})),P=e=>{let s=new Date(1e3*e).toISOString().substr(11,8);return 0===s.indexOf("00:")?s.substr(3):s},N=(e,s)=>0===e?s:s===e-1?0:s+1,M={once:!0};var k=(e,s)=>{for(const[t,o]of s)e[t]=o;return e};const w=[(e=>(n("data-v-01af3e97"),e=e(),r(),e))((()=>a("div",{class:"circle"},null,-1)))];var T=k({props:{isPlay:{type:Boolean,require:!0},src:{type:String,require:!0},m:{type:String,default:"0"},imgP:{type:String,default:"6px"},style:{type:Object,default:()=>({})}},setup(n){const r=n;return e((e=>({"1135831c":`url(${r.src})`,"094f27e1":n.m}))),(e,a)=>(s(),t("div",{class:o({play:n.isPlay,paused:!n.isPlay,"music-avatar":!0}),style:i(r.style)},w,6))}},[["__scopeId","data-v-01af3e97"]]);const q={class:"container"},S={class:"cur-time"},B={class:"duration"};var E=k({props:{curTime:{type:Number,require:!0},duration:{type:Number,require:!0}},emits:["change_progress"],setup(o,{emit:i}){const n=o;e((e=>({c37570fe:`${u(d)}%`})));const r=e=>{const s=e.target,t=e.clientX,{width:o,left:n}=s.getBoundingClientRect();i("change_progress",Number(((t-n)/o).toFixed(2)))},d=l((()=>0===n.duration||0===n.curTime?0:n.curTime/n.duration*100));return(e,i)=>(s(),t("div",q,[a("div",S,c(u(P)(o.curTime)),1),a("div",{id:"progress-bar",onClick:r}),a("div",B,c(u(P)(o.duration)),1)]))}},[["__scopeId","data-v-20a3bb18"]]);const A={class:"container"};var D=k({props:{isMuted:{type:Boolean,require:!0},volume:{type:Number,default:.5},test:{type:Number,default:.5}},emits:["change_volume","change_mute"],setup(o,{emit:i}){e((e=>({a8749fba:100*o.volume+"%"})));const n=e=>{const s=e.target,t=e.clientX,{width:o,left:n}=s.getBoundingClientRect();i("change_volume",Number(((t-n)/o).toFixed(2)))};return(e,r)=>(s(),t("div",A,[d(u(p),{icon:o.isMuted?"bx:bx-volume-mute":o.volume>=.5?"bx:bx-volume-full":"bx:bx-volume-low",width:"1.2rem",color:"#fff",class:"icon",onClick:r[0]||(r[0]=e=>i("change_mute"))},null,8,["icon"]),a("div",{class:"progress",onClick:n})]))}},[["__scopeId","data-v-09a977cc"]]);var F=k({props:{mode:{type:String,default:"single_loop"}},emits:["change_mode"],setup:(e,{emit:t})=>(o,i)=>(s(),m(u(p),{icon:""+(e.mode===u("single_loop")?"carbon:repeat-one":e.mode===u("all_loop")?"carbon:repeat":"bi:music-note-list"),color:"white",width:"1.2rem",class:"icon",onClick:i[0]||(i[0]=s=>t("change_mode",e.mode===u("single_loop")?u("all_loop"):e.mode===u("all_loop")?u("list_loop"):u("single_loop")))},null,8,["icon"]))},[["__scopeId","data-v-00af7447"]]);const O={class:"container"},j=["onClick"],J={class:"item"},R={key:1};var X=k({props:{songList:{type:Array,require:!0},setCurIdx:{type:Function,require:!0},curIdx:{type:Number,require:!0},isPlay:{type:Boolean,require:!0}},emits:["play"],setup(e,{emit:i}){const n=e;return(r,l)=>(s(),t("div",O,[a("ul",null,[(s(!0),t(g,null,y(e.songList,((r,l)=>(s(),t("li",{key:r.id,onClick:()=>(e=>{i("play"),n.setCurIdx(e)})(l),class:o({current:l===e.curIdx})},[a("div",J,[l===e.curIdx?(s(),m(u(p),{key:0,icon:"fluent:music-note-2-play-20-filled",width:"20",height:"20",class:o({play:e.isPlay,pause:e.isPlay,icon:e.isPlay})},null,8,["class"])):(s(),t("span",R,c(l+1),1)),a("span",null,c(r.artist.length>0?r.artist:"未知来源"),1),a("span",null,c(r.songName),1)])],10,j)))),128))])]))}},[["__scopeId","data-v-3962c632"]]);const $={class:"music-player-wrapper"},K=["src"],U={class:"content"},z={class:"info"},G={class:"name"},H={class:"artist"},Q={class:"control"},V={class:"action"},W={props:{songList:{type:Array,default:[{src:"1.mp3",pic:"1.png",artist:"JJ Lin",songName:"Allways online",id:L()},{src:"2.mp3",pic:"2.png",songName:"山川",artist:"李荣浩",id:L()},{src:"3.mp3",pic:"1.png",artist:"Jay",songName:"一路向北",id:L()},{src:"4.mp3",pic:"2.png",songName:"触不可及",artist:"佚名",id:L()}]},loopMode:{type:String,default:"single_loop"},volume:{type:Number,default:.3},isMuted:{type:Boolean,default:!1}},setup(e){const o=e,{isMuted:i,volume:n,loopMode:r}=o,g=v({v_isMuted:i,v_loopMode:r,v_volume:n,isPlay:!1,curTime:0,curIdx:0,curDuration:0,isCanplay:!1}),y=f(null),b=l((()=>{const{src:e="1.mp3",pic:s="1.png",artist:t="林俊杰",songName:i="allways online"}=o.songList[g.curIdx]||{};return{src:e,pic:s,songName:i,artist:t}})),I=(e="turn")=>{var s,t;if(0!==o.songList.length)if("turn"===e)g.isPlay=!g.isPlay;else{const i=g.curIdx;"next"===e?g.curIdx=N(o.songList.length,i):"prev"===e&&(g.curIdx=(s=o.songList.length,t=i,0===s?t:0===t?s-1:t-1))}};x(g,(()=>{const e=y.value;e&&(g.curDuration=e.duration,e.volume=g.v_volume,e.muted=g.v_isMuted,e.paused&&g.isPlay?g.isCanplay&&setTimeout((()=>{e.play()}),30):e.paused||g.isPlay||e.pause())}));const C=e=>g.v_loopMode=e,L=()=>g.v_isMuted=!g.v_isMuted,P=e=>g.v_volume=e,k=e=>{const s=y.value;s&&(s.currentTime=g.duration*e)};return _((()=>{const e=y.value,s=()=>{0!==e.currentTime&&g.curTime<g.duration&&(g.curTime=e.currentTime)},t=()=>{g.curTime=0,"all_loop"===g.v_loopMode?(g.isCanplay=!1,g.curIdx=N(o.songList.length,g.curIdx)):"list_loop"===g.v_loopMode?g.curIdx!==o.songList.length-1?(g.isCanplay=!1,g.curIdx=N(o.songList.length,g.curIdx)):(g.isCanplay=!0,g.isPlay=!1):g.isPlay=!0};e.addEventListener("durationchange",(()=>{g.duration=e.duration,e.addEventListener("timeupdate",s),e.addEventListener("ended",t,M),e.addEventListener("canplay",(()=>g.isCanplay=!0),M)}))})),(e,i)=>(s(),t("div",$,[a("audio",{ref:(e,s)=>{s.audioRef=e,y.value=e},src:u(b).src,preload:"auto"},null,8,K),a("div",U,[d(T,{src:u(b).pic,isPlay:u(g).isPlay},null,8,["src","isPlay"]),a("div",z,[a("div",G,c(u(b).songName),1),a("div",H,c(u(b).artist),1)]),a("div",Q,[a("div",V,[d(u(p),{onClick:i[0]||(i[0]=()=>I("prev")),class:"icon",icon:"bx:bxs-skip-previous-circle",color:"#fff",width:"1.6rem"}),d(u(p),{onClick:i[1]||(i[1]=()=>I()),class:"icon",icon:u(g).isPlay?"mdi:motion-pause-outline":"mdi:motion-play-outline",color:"#fff",width:"2rem"},null,8,["icon"]),d(u(p),{onClick:i[2]||(i[2]=()=>I("next")),class:"icon",icon:"bx:bxs-skip-next-circle",color:"#fff",width:"1.6rem"})]),d(D,{volume:u(g).v_volume,isMuted:u(g).v_isMuted,onChange_mute:L,onChange_volume:P},null,8,["volume","isMuted"])]),d(E,{curTime:u(g).curTime,duration:u(g).curDuration,onChange_progress:k},null,8,["curTime","duration"]),d(F,{onChange_mode:C,mode:u(g).v_loopMode},null,8,["mode"])]),o.songList.length>0?(s(),m(X,{key:0,songList:o.songList,setCurIdx:e=>u(g).curIdx=e,curIdx:u(g).curIdx,isPlay:u(g).isPlay,onPlay:i[3]||(i[3]=()=>u(g).isPlay=!0)},null,8,["songList","setCurIdx","curIdx","isPlay"])):h("",!0)]))}};C({setup(e){const t=f([]);return I((async()=>{const e=await async function(){const{data:e}=await b.get("http://110.42.133.25:3333/api/songs");return e.data}();t.value=e.map((e=>{const{url:s,songId:t,artist:o,picUrl:i,songName:n}=e;return{src:s,pic:i,id:t.toString(),artist:o,songName:n}}))})),(e,o)=>(s(),m(W,{songList:t.value},null,8,["songList"]))}}).mount("#app");
